// Prisma schema file

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  userId           Int         @id @default(autoincrement())
  username         String      @unique
  hashedPassword   String
  bio              String?
  posts            Post[]
  comments         Comment[]
  likes            Like[]
  followers        Follower[]  @relation("followerRelation")
  following        Follower[]  @relation("followingRelation")
}

model Post {
  postId       Int         @id @default(autoincrement())
  userId       Int
  imageUrl     String
  caption      String?
  createdAt    DateTime    @default(now())
  user         User        @relation(fields: [userId], references: [userId])
  comments     Comment[]
  likes        Like[]
}

model Comment {
  commentId    Int       @id @default(autoincrement())
  postId       Int
  userId       Int
  text         String
  createdAt    DateTime  @default(now())
  post         Post      @relation(fields: [postId], references: [postId])
  user         User      @relation(fields: [userId], references: [userId])
}

model Like {
  likeId       Int       @id @default(autoincrement())
  postId       Int
  userId       Int
  post         Post      @relation(fields: [postId], references: [postId])
  user         User      @relation(fields: [userId], references: [userId])
}

model Follower {
  followerId   Int       @relation("followerRelation", fields: [followerId], references: [userId])
  followingId  Int       @relation("followingRelation", fields: [followingId], references: [userId])
  @@id([followerId, followingId])
}